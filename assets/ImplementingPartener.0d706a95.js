import{o as t,c as o,a as e,p as Q,X as Z,r as v,u as G,s as K,d as R,Y as ee,e as te,B as F,f as h,w as y,j as oe,F as k,v as $,h as C,t as _,z as d,i as M,x as L,g as E,Z as ne}from"./index.f93fa277.js";import{_ as re}from"./BrForm.1b99631b.js";const se={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 16 16"},ie=e("g",{fill:"currentColor"},[e("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}),e("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1),ae=[ie];function ce(u,n){return t(),o("svg",se,ae)}var le={name:"bi-plus-circle",render:ce};const de={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 20 20"},he=e("path",{fill:"currentColor",d:"M9.163 4.516c.418.408 4.502 4.695 4.502 4.695a1.095 1.095 0 0 1 0 1.576s-4.084 4.289-4.502 4.695c-.418.408-1.17.436-1.615 0c-.446-.434-.481-1.041 0-1.574L11.295 10L7.548 6.092c-.481-.533-.446-1.141 0-1.576c.445-.436 1.197-.409 1.615 0z"},null,-1),me=[he];function _e(u,n){return t(),o("svg",de,me)}var ue={name:"entypo-chevron-right",render:_e};const pe={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 26 26"},ve=e("path",{fill:"currentColor",d:"M8.813 0A1 1 0 0 0 8 1v1H4.406C3.606 2 3 2.606 3 3.406V24.5c0 .9.606 1.5 1.406 1.5H21.5c.8 0 1.406-.606 1.406-1.406V3.406c.1-.8-.512-1.406-1.312-1.406H18V1a1 1 0 0 0-1-1H9a1 1 0 0 0-.094 0a1 1 0 0 0-.094 0zM10 2h6v2h-6V2zM5 4h3v1a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4h3v20H5V4zm2 5v4h4V9H7zm1 1h2v2H8v-2zm5 0v2h6v-2h-6zm-6 5v4h4v-4H7zm6 1v2h6v-2h-6z"},null,-1),fe=[ve];function ge(u,n){return t(),o("svg",pe,fe)}var ye={name:"wpf-survey",render:ge};const xe={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},be=e("path",{fill:"currentColor",d:"M10 6v2h12.59L6 24.59L7.41 26L24 9.41V22h2V6H10z"},null,-1),we=[be];function ke(u,n){return t(),o("svg",xe,we)}var $e={name:"carbon-arrow-up-right",render:ke};const Ce={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 448 512"},Se=e("path",{fill:"currentColor",d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},null,-1),ze=[Se];function Me(u,n){return t(),o("svg",Ce,ze)}var Le={name:"fa-solid-chevron-down",render:Me};const Ve={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},Be=e("path",{fill:"currentColor",d:"M26 20h-2v4h-4v2h4v4h2v-4h4v-2h-4z"},null,-1),He=e("path",{fill:"currentColor",d:"M28 8H16l-3.4-3.4c-.4-.4-.9-.6-1.4-.6H4c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h14v-2H4V6h7.2l3.4 3.4l.6.6H28v8h2v-8c0-1.1-.9-2-2-2z"},null,-1),Pe=[Be,He];function Ae(u,n){return t(),o("svg",Ve,Pe)}var Ie={name:"carbon-folder-add",render:Ae};const Re={class:"iom-impl-par pb-4 overflow-hidden mt-4"},Fe={key:0,class:"flex flex-col items-center justify-center relative md:px-12 py-6 transform"},Ee=e("h5",{class:"text-dark-900 text-lg font-normal mt-3"},[e("span",null,"+"),C(" Implementing Partner")],-1),je={key:1,class:"pt-2 w-full h-full"},Ne=["data-index"],Ye={class:"shadow relative block border transition-all bg-primary-50 <md:border-primary-200 md:bg-light-200 rounded-lg overflow-hidden"},qe={class:"!leading-5 w-full px-2 py-3 border-b bg-gradient-to-r from-primary-400/40 via-primary-300/30 to-primary-400/40 text-primary-900 text-center cursor-default"},Te=["onClick"],De={class:"loc-mark inline-block underline underline-primary-300"},Oe={class:"md:flex"},Ue={class:"px-2 transition-all relative flex items-center md:w-1/3 !md:h-inherit <md:overflow-hidden <md:border-b"},Je={class:"space-y-3 mt-3 pb-2 mx-auto transform -translate-x-1"},We=["onClick"],Xe={class:"br-selbox__stacked--item--inputs cursor-pointer flex items-center"},Qe={class:"pl-2 truncate group-hover:text-dark-500"},Ze={class:"w-full divide-y-1 border-l bg-white border-dark-200 h-full children:h-full children:relative children:transition-all children:flex-col children:px-3 children:py-5 children:items-start children:w-full children:text-black"},Ge=["onClick"],Ke={key:0,class:"px-3 -ml-px mb-2 mr-6 w-content h-content text-2xs bg-success-100 border border-success-200 text-success-600 rounded-full"},et=e("div",{class:"group-hover:text-success-700"},"Completed",-1),tt=[et],ot={key:1,class:"px-3 -ml-px mb-2 mr-6 w-content h-content text-2xs bg-warning-100 border border-warning-200 text-warning-600 rounded-full"},nt=e("div",{class:"group-hover:text-warning-700"},"Pending",-1),rt=[nt],st={key:0,class:"px-3 -ml-px mb-2 mr-6 w-content h-content text-2xs bg-primary-100 border border-primary-200 text-primary-600 rounded-full"},it={class:"group-hover:text-primary-700"},at={key:1,class:"px-3 -ml-px mb-2 mr-6 w-content h-content text-2xs bg-warning-100 border border-warning-200 text-warning-600 rounded-full"},ct=e("div",{class:"group-hover:text-warning-700"},"Pending",-1),lt=[ct],dt={class:"flex"},ht={class:"underline-primary-600/30 underline underline-2px mr-2"},mt={class:"flex text-dark-500 !text-xs mt-1 transition-colors"},_t={key:3,class:"mt-8"},ut={class:"space-y-3 children:rounded children:flex children:items-center children:text-xs children:py-2 children:px-3 children:bg-dark-100 children:shadow children:transition-all children:duration-200"},pt=["onClick"],vt=C("Survey from "),ft={class:"ml-1 font-medium"},gt=["onClick"],yt=C(),xt=e("span",{class:"ml-2"},"Add new questionnaire",-1),$t={__name:"ImplementingPartener",setup(u){const n=Q(),{width:V}=Z(),f=v(""),B=v(null),j=v(null),N=v(null),H=v([]),S=v(!0),Y=G(),P={},q=s=>{if(V.value>=768)return;const i=document.querySelector(`.iom-impl-par .iom-part:nth-child(${s+1}) aside`),m=i.offsetHeight,c=.1;if(!m)return E.to(i,{duration:c,height:P[s]});E.to(i,{duration:c,height:0})},T=async(s,{setErrors:i,notify:m})=>{s.id=3,f.value="",n.$patch(c=>{c.ips.unshift(s)})},D=s=>{const i={year:"numeric",month:"long",day:"numeric"};return s=new Date(s),s.toLocaleDateString(void 0,i)},z=({id:s},{key:i},m={})=>{const{empty:c}=m,l=s,x=n.selectedSurveyLocation[l],b={loc:x};if(!c){const w=n.surveys.find(g=>g.survey==i&&g.ip==l&&g.location==x);w&&(b.id=w.id)}Y.push({name:`${i}-survey`,params:{ip:l},query:b})},O=()=>{},A=async(s={})=>{S.value=!0;const i=encodeURIComponent(JSON.stringify({population:{$gt:1e4},...s})),m=await fetch(`https://parseapi.back4app.com/classes/greeceCities_List_of_Greek_cities?limit=10&order=-population&keys=name&where=${i}`,{headers:{"X-Parse-Application-Id":"7ULzjba6mbRxuCi9O3umzEUnVhI5fcO14LCJlWeQ","X-Parse-REST-API-Key":"pOJV0euvADHJohCkybQkmxBb9oypFnztrcbOZ8zx"}});try{const c=await m.json();c&&c.results&&(H.value=c.results.map(l=>l.name).sort())}finally{S.value=!1}};K(async()=>{window.store=n,document.querySelectorAll(".iom-impl-par aside").forEach((s,i)=>{P[i]=s.offsetHeight,s.style.height=0}),await A(),V.value>=768});const U=async()=>{f.value!=="add"&&(f.value="add")},J={form:{type:"stacked-int",save:"perForm"},fields:[{name:"name",label:"Implementing Partner's Name",type:"text",parentClasses:"br-span-full",rules:R().required(),placeholder:"Red Cross"},{name:"locations",section:"aux",label:"Enter IP's locations",rules:ee().min(1).required().of(R()),type:"tagger",parentClasses:"br-span-full",helpText:"Select city locations of this IP's facilities by typing in the city name, followed by comma or Enter",extra:{enableHints:!0,choicesLoading:S,choices:H,onSearchInput:async(s,i)=>{i==0&&await A({name:{$regex:s}})}}}]};return(s,i)=>{const m=Ie,c=re,l=te("br-transition"),x=Le,b=ne,w=$e,g=ye,W=ue,X=le;return t(),o("section",Re,[e("article",{onClick:U,key:"add",class:"w-full group py-1 px-4",ref_key:"addIP",ref:j},[e("div",{class:F(["overflow-hidden h-full flex items-center justify-center border-dashed bg-white transition-all cursor-pointer rounded-lg",[f.value!=="add"?"border-2 border-dark-200 hover:bg-dark-50":"transparent"]])},[h(l,{name:"verticalBlur",class:"w-full overflow-auto"},{default:y(()=>[f.value?(t(),o("div",je,[h(c,oe({ref_key:"addform",ref:N,"persist-state":!0,name:"addip",class:"iom-addip",modelValue:B.value,"onUpdate:modelValue":i[0]||(i[0]=a=>B.value=a)},{schema:J,onFormErrors:O,onFormValid:T},{"submit-text":"Create new IP"}),null,16,["modelValue"])])):(t(),o("div",Fe,[h(m,{class:"text-dark-400 w-11 h-11"}),Ee]))]),_:1})],2)],512),h(l,{type:"group",name:"dissolve",duration:.6,tag:"ul"},{default:y(()=>[(t(!0),o(k,null,$(d(n).ips,(a,I)=>(t(),o("li",{key:a.name,class:"iom-part w-full py-1 lg:py-3 px-4 mt-4","data-index":I},[e("section",Ye,[e("h4",qe,[C(_(a.name)+" facility in ",1),h(l,{name:"verticalBlur"},{default:y(()=>[d(n).selectedSurveyLocation[a.id]?(t(),o("span",{key:d(n).selectedSurveyLocation[a.id],class:"text-primary-600 group <md:text-primary-600 <md:cursor-pointer <md:active:text-primary-700 <md:hover:text-primary-500",onClick:r=>q(I)},[e("span",De,_(d(n).selectedSurveyLocation[a.id]),1),h(x,{class:"relative transform transition-transform inline-block h-3.5 md:hidden <md:bottom-0.2 <md:-left-0.5 <md:group-active:scale-90"})],8,Te)):M("",!0)]),_:2},1024)]),e("div",Oe,[e("aside",Ue,[e("ul",Je,[(t(!0),o(k,null,$(a.locations,r=>(t(),o("li",{key:r,class:"flex justify-start items-center text-dark-700 font-medium group",onClick:p=>d(n).selectedSurveyLocation[a.id]=r},[e("div",Xe,[h(b,{name:r,id:r,checked:d(n).selectedSurveyLocation[a.id]==r,class:"flex-shrink-0 !bg-white"},null,8,["name","id","checked"]),e("div",Qe,_(r),1)])],8,We))),128))])]),e("section",Ze,[(t(!0),o(k,null,$(d(n).surveyTypes,r=>(t(),o("div",{key:r.key,class:F(r.key!=="benef"?"cursor-pointer transition-colors duration-300 hover:bg-primary-50/70 group":""),onClick:p=>r.key=="benef"?()=>{}:z(a,r)},[r.key!=="benef"?(t(),L(w,{key:0,class:"text-dark-500/60 absolute m-3 top-0 right-0"})):M("",!0),r.key!=="benef"?(t(),L(l,{key:1,name:"horizontalBlur"},{default:y(()=>[d(n).getSurveyStatus(a.id,r.key)=="ok"?(t(),o("div",Ke,tt)):(t(),o("div",ot,rt))]),_:2},1024)):(t(),L(l,{key:2,name:"horizontalBlur"},{default:y(()=>[d(n).getBenefSurveys(a.id).length>=1?(t(),o("div",st,[e("div",it,"Completed "+_(d(n).getBenefSurveys(a.id).length)+" of 3",1)])):(t(),o("div",at,lt))]),_:2},1024)),e("div",dt,[e("span",ht,_(r.title),1)]),e("span",mt,_(r.desc),1),r.key=="benef"?(t(),o("section",_t,[e("div",null,[e("ul",ut,[(t(!0),o(k,null,$(d(n).getBenefSurveys(a.id),p=>(t(),o("li",{key:p.id,class:"hover:bg-light-200 hover:cursor-pointer active:shadow-sm relative",onClick:bt=>z(a,r)},[h(g,{class:"w-4 h-4 mr-3"}),vt,e("span",ft,_(D(p.date||p.inter_date)),1),h(W,{class:"absolute right-2 text-slate-400"})],8,pt))),128)),e("li",{onClick:p=>z(a,r,{empty:!0}),class:"!bg-white border border-dashed !shadow-none font-medium border-dark-300 justify-center hover:cursor-pointer hover:border-solid hover:border-primary-200 hover:text-primary-600 !hover:bg-primary-50"},[h(X),yt,xt],8,gt)])])])):M("",!0)],10,Ge))),128))])])])],8,Ne))),128))]),_:1})])}}};export{$t as default};
