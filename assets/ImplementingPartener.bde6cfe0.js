import{o as t,c as o,a as e,X as Z,f as u,t as m,z as h,i as b,h as y,p as G,Y as K,r as f,u as ee,s as te,d as R,Z as ne,e as oe,B as F,w as x,j as re,F as z,v as M,x as S,g as j,$ as se,a0 as ie}from"./index.3b4a424b.js";import{_ as ae}from"./BrForm.18a91fc2.js";const ce={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 16 16"},le=e("g",{fill:"currentColor"},[e("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}),e("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1),de=[le];function he(c,n){return t(),o("svg",ce,de)}var ue={name:"bi-plus-circle",render:he};const _e={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 20 20"},me=e("path",{fill:"currentColor",d:"M9.163 4.516c.418.408 4.502 4.695 4.502 4.695a1.095 1.095 0 0 1 0 1.576s-4.084 4.289-4.502 4.695c-.418.408-1.17.436-1.615 0c-.446-.434-.481-1.041 0-1.574L11.295 10L7.548 6.092c-.481-.533-.446-1.141 0-1.576c.445-.436 1.197-.409 1.615 0z"},null,-1),pe=[me];function ve(c,n){return t(),o("svg",_e,pe)}var fe={name:"entypo-chevron-right",render:ve};const ye={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 26 26"},ge=e("path",{fill:"currentColor",d:"M8.813 0A1 1 0 0 0 8 1v1H4.406C3.606 2 3 2.606 3 3.406V24.5c0 .9.606 1.5 1.406 1.5H21.5c.8 0 1.406-.606 1.406-1.406V3.406c.1-.8-.512-1.406-1.312-1.406H18V1a1 1 0 0 0-1-1H9a1 1 0 0 0-.094 0a1 1 0 0 0-.094 0zM10 2h6v2h-6V2zM5 4h3v1a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4h3v20H5V4zm2 5v4h4V9H7zm1 1h2v2H8v-2zm5 0v2h6v-2h-6zm-6 5v4h4v-4H7zm6 1v2h6v-2h-6z"},null,-1),xe=[ge];function be(c,n){return t(),o("svg",ye,xe)}var we={name:"wpf-survey",render:be};const ke={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},$e=e("path",{fill:"currentColor",d:"m27 25.586l-2-2V21h-2v3.414L25.586 27L27 25.586z"},null,-1),Ce=e("path",{fill:"currentColor",d:"M24 31a7 7 0 1 1 7-7a7.008 7.008 0 0 1-7 7zm0-12a5 5 0 1 0 5 5a5.005 5.005 0 0 0-5-5zm-8 9A12.013 12.013 0 0 1 4 16H2a14.016 14.016 0 0 0 14 14zM12 8H7.078A11.984 11.984 0 0 1 28 16h2A13.978 13.978 0 0 0 6 6.234V2H4v8h8z"},null,-1),ze=[$e,Ce];function Me(c,n){return t(),o("svg",ke,ze)}var Se={name:"carbon-update-now",render:Me};const Le={key:0,class:"pt-4 mt-4 flex justify-center items-center text-xs text-dark-400 border-t border-dashed"},Ve={class:"ml-2"},He=y(" Last updated by "),Ae=y(),Be={__name:"IomSurveyMetadata",props:["survey"],setup(c){const n=Z("since");return(L,p)=>{const w=Se;return c.survey&&c.survey.uby&&c.survey.uon?(t(),o("div",Le,[u(w,{class:"flex-none w-4.5 h-4.5 text-primary-400"}),e("p",Ve,[He,e("b",null,m(c.survey.uby),1),Ae,e("i",null,m(h(n).format(new Date(c.survey.uon))),1)])])):b("",!0)}}},Ie={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},Pe=e("path",{fill:"currentColor",d:"M10 6v2h12.59L6 24.59L7.41 26L24 9.41V22h2V6H10z"},null,-1),Re=[Pe];function Fe(c,n){return t(),o("svg",Ie,Re)}var je={name:"carbon-arrow-up-right",render:Fe};const Ee={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 448 512"},Ye=e("path",{fill:"currentColor",d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},null,-1),Ne=[Ye];function qe(c,n){return t(),o("svg",Ee,Ne)}var De={name:"fa-solid-chevron-down",render:qe};const Te={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},Oe=e("path",{fill:"currentColor",d:"M26 20h-2v4h-4v2h4v4h2v-4h4v-2h-4z"},null,-1),Ue=e("path",{fill:"currentColor",d:"M28 8H16l-3.4-3.4c-.4-.4-.9-.6-1.4-.6H4c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h14v-2H4V6h7.2l3.4 3.4l.6.6H28v8h2v-8c0-1.1-.9-2-2-2z"},null,-1),Je=[Oe,Ue];function We(c,n){return t(),o("svg",Te,Je)}var Xe={name:"carbon-folder-add",render:We};const Qe={class:"iom-impl-par pb-4 overflow-hidden mt-4"},Ze={key:0,class:"flex flex-col items-center justify-center relative md:px-12 py-6 transform"},Ge=e("h5",{class:"text-dark-900 text-lg font-normal mt-3"},[e("span",null,"+"),y(" Implementing Institution")],-1),Ke={key:1,class:"pt-2 w-full h-full"},et=["data-index"],tt={class:"shadow relative block border transition-all bg-primary-50 <md:border-primary-200 md:bg-light-200 rounded-lg overflow-hidden"},nt={class:"!leading-5 w-full px-2 py-3 border-b bg-gradient-to-r from-primary-400/40 via-primary-300/30 to-primary-400/40 text-primary-900 text-center cursor-default"},ot=["onClick"],rt={class:"loc-mark inline-block underline underline-primary-300"},st={class:"md:flex"},it={class:"px-2 transition-all relative flex items-center md:w-1/3 !md:h-inherit <md:overflow-hidden <md:border-b"},at={class:"space-y-3 mt-3 pb-2 mx-auto transform -translate-x-1"},ct=["onClick"],lt={class:"br-selbox__stacked--item--inputs cursor-pointer flex items-center"},dt={class:"pl-2 truncate group-hover:text-dark-500"},ht={class:"w-full divide-y-1 border-l bg-white border-dark-200 h-full children:h-full children:relative children:transition-all children:flex-col children:px-3 children:py-5 children:items-start children:w-full children:text-black"},ut=["onClick"],_t={key:0,class:"px-3 -ml-px mb-2 mr-6 w-content h-content text-2xs bg-success-100 border border-success-200 text-success-600 rounded-full"},mt=e("div",{class:"group-hover:text-success-700"},"Completed",-1),pt=[mt],vt={key:1,class:"px-3 -ml-px mb-2 mr-6 w-content h-content text-2xs bg-warning-100 border border-warning-200 text-warning-600 rounded-full"},ft=e("div",{class:"group-hover:text-warning-700"},"Pending",-1),yt=[ft],gt={key:0,class:"px-3 -ml-px mb-2 mr-6 w-content h-content text-2xs bg-primary-100 border border-primary-200 text-primary-600 rounded-full"},xt={class:"group-hover:text-primary-700"},bt={key:1,class:"px-3 -ml-px mb-2 mr-6 w-content h-content text-2xs bg-warning-100 border border-warning-200 text-warning-600 rounded-full"},wt=e("div",{class:"group-hover:text-warning-700"},"Pending",-1),kt=[wt],$t={class:"flex"},Ct={class:"underline-primary-600/30 underline underline-2px mr-2"},zt={class:"flex text-dark-500 !text-xs mt-1 transition-colors"},Mt={key:4,class:"mt-8"},St={class:"space-y-3 children:rounded children:flex children:items-center children:text-xs children:py-2 children:px-3 children:bg-dark-100 children:shadow children:transition-all children:duration-200"},Lt=["onClick"],Vt=y("Survey from "),Ht={class:"ml-1 font-medium"},At=["onClick"],Bt=y(),It=e("span",{class:"ml-2"},"Add new questionnaire",-1),jt={__name:"ImplementingPartener",setup(c){const n=G(),{width:L}=K(),p=f(""),w=f(null),E=f(null),Y=f(null),A=f([]),V=f(!0),N=ee(),B={},q=s=>{if(L.value>=768)return;const i=document.querySelector(`.iom-impl-par .iom-part:nth-child(${s+1}) aside`),_=i.offsetHeight,l=.1;if(!_||_==1)return j.to(i,{duration:l,height:B[s]});j.to(i,{duration:l,height:0})},D=async(s,{setErrors:i,notify:_})=>{const l=await se(s);l.status===200&&(s.id=l.data.id,p.value="",n.$patch(d=>{d.ips.unshift(s)}))},T=s=>{const i={year:"numeric",month:"long",day:"numeric"};return s=new Date(s),s.toLocaleDateString(void 0,i)},H=({id:s},{key:i},_={})=>{const{empty:l}=_,d=s,k=n.selectedSurveyLocation[d],$={loc:k};if(!l){const C=n.surveys.find(g=>g.survey==i&&g.ip==d&&g.location==k);C&&($.id=C.id)}N.push({name:`${i}-survey`,params:{ip:d},query:$})},O=()=>{},I=async(s={})=>{V.value=!0;const i=encodeURIComponent(JSON.stringify({population:{$gt:1e4},...s})),_=await fetch(`https://parseapi.back4app.com/classes/greeceCities_List_of_Greek_cities?limit=10&order=-population&keys=name&where=${i}`,{headers:{"X-Parse-Application-Id":"7ULzjba6mbRxuCi9O3umzEUnVhI5fcO14LCJlWeQ","X-Parse-REST-API-Key":"pOJV0euvADHJohCkybQkmxBb9oypFnztrcbOZ8zx"}});try{const l=await _.json();l&&l.results&&(A.value=l.results.map(d=>d.name).sort())}finally{V.value=!1}};te(async()=>{window.store=n,document.querySelectorAll(".iom-impl-par aside").forEach((s,i)=>{B[i]=s.offsetHeight,s.style.height=0}),await I(),L.value>=768});const U=async()=>{p.value!=="add"&&(p.value="add")},J={form:{type:"stacked-int",save:"perForm"},fields:[{name:"name",label:"Name of the Implementing Institution",type:"text",parentClasses:"br-span-full",rules:R().required(),placeholder:"Red Cross"},{name:"locations",section:"aux",label:"Enter IP's locations",rules:ne().min(1).required().of(R()),type:"tagger",parentClasses:"br-span-full",helpText:"Select city locations of this IP's facilities by typing in the city name, followed by comma or Enter",extra:{enableHints:!0,choicesLoading:V,choices:A,onSearchInput:async(s,i)=>{i==0&&await I({name:{$regex:s}})}}}]};return(s,i)=>{const _=Xe,l=ae,d=oe("br-transition"),k=De,$=ie,C=je,g=Be,W=we,X=fe,Q=ue;return t(),o("section",Qe,[e("article",{onClick:U,key:"add",class:"w-full group py-1 px-4",ref_key:"addIP",ref:E},[e("div",{class:F(["overflow-hidden h-full flex items-center justify-center border-dashed bg-white transition-all cursor-pointer rounded-lg",[p.value!=="add"?"border-2 border-dark-200 hover:bg-dark-50":"transparent"]])},[u(d,{name:"verticalBlur",class:"w-full overflow-auto"},{default:x(()=>[p.value?(t(),o("div",Ke,[u(l,re({ref_key:"addform",ref:Y,"persist-state":!0,name:"addip",class:"iom-addip",modelValue:w.value,"onUpdate:modelValue":i[0]||(i[0]=a=>w.value=a)},{schema:J,onFormErrors:O,onFormValid:D},{"submit-text":"Create new IP"}),null,16,["modelValue"])])):(t(),o("div",Ze,[u(_,{class:"text-dark-400 w-11 h-11"}),Ge]))]),_:1})],2)],512),u(d,{type:"group",name:"dissolve",duration:.6,tag:"ul"},{default:x(()=>[(t(!0),o(z,null,M(h(n).ips,(a,P)=>(t(),o("li",{key:a.name,class:"iom-part w-full py-1 lg:py-3 px-4 mt-4","data-index":P},[e("section",tt,[e("h4",nt,[y(m(a.name)+" facility in ",1),u(d,{name:"verticalBlur"},{default:x(()=>[h(n).selectedSurveyLocation[a.id]?(t(),o("span",{key:h(n).selectedSurveyLocation[a.id],class:"text-primary-600 group <md:text-primary-600 <md:cursor-pointer <md:active:text-primary-700 <md:hover:text-primary-500",onClick:r=>q(P)},[e("span",rt,m(h(n).selectedSurveyLocation[a.id]),1),u(k,{class:"relative transform transition-transform inline-block h-3.5 md:hidden <md:bottom-0.2 <md:-left-0.5 <md:group-active:scale-90"})],8,ot)):b("",!0)]),_:2},1024)]),e("div",st,[e("aside",it,[e("ul",at,[(t(!0),o(z,null,M(a.locations,r=>(t(),o("li",{key:r,class:"flex justify-start items-center text-dark-700 font-medium group",onClick:v=>h(n).selectedSurveyLocation[a.id]=r},[e("div",lt,[u($,{name:r,id:r,checked:h(n).selectedSurveyLocation[a.id]==r,class:"flex-shrink-0 !bg-white"},null,8,["name","id","checked"]),e("div",dt,m(r),1)])],8,ct))),128))])]),e("section",ht,[(t(!0),o(z,null,M(h(n).surveyTypes,r=>(t(),o("div",{key:r.key,class:F(r.key!=="benef"?"cursor-pointer transition-colors duration-300 hover:bg-primary-50/70 group":""),onClick:v=>r.key=="benef"?()=>{}:H(a,r)},[r.key!=="benef"?(t(),S(C,{key:0,class:"text-dark-500/60 absolute m-3 top-0 right-0"})):b("",!0),r.key!=="benef"?(t(),S(d,{key:1,name:"horizontalBlur"},{default:x(()=>[h(n).getSurveyStatus(a.id,r.key)=="ok"?(t(),o("div",_t,pt)):(t(),o("div",vt,yt))]),_:2},1024)):(t(),S(d,{key:2,name:"horizontalBlur"},{default:x(()=>[h(n).getBenefSurveys(a.id).length>=1?(t(),o("div",gt,[e("div",xt,"Completed "+m(h(n).getBenefSurveys(a.id).length)+" of 3",1)])):(t(),o("div",bt,kt))]),_:2},1024)),e("div",$t,[e("span",Ct,m(r.title),1)]),e("span",zt,m(r.desc),1),r.key!=="benef"?(t(),S(g,{key:3,survey:h(n).getSurvey(a.id,r.key)},null,8,["survey"])):b("",!0),r.key=="benef"?(t(),o("section",Mt,[e("div",null,[e("ul",St,[(t(!0),o(z,null,M(h(n).getBenefSurveys(a.id),v=>(t(),o("li",{key:v.id,class:"hover:bg-light-200 hover:cursor-pointer active:shadow-sm relative",onClick:Pt=>H(a,r)},[u(W,{class:"w-4 h-4 mr-3"}),Vt,e("span",Ht,m(T(v.date||v.inter_date)),1),u(X,{class:"absolute right-2 text-slate-400"})],8,Lt))),128)),e("li",{onClick:v=>H(a,r,{empty:!0}),class:"!bg-white border border-dashed !shadow-none font-medium border-dark-300 justify-center hover:cursor-pointer hover:border-solid hover:border-primary-200 hover:text-primary-600 !hover:bg-primary-50"},[u(Q),Bt,It],8,At)])])])):b("",!0)],10,ut))),128))])])])],8,et))),128))]),_:1})])}}};export{jt as default};
