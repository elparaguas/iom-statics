import{_ as O}from"./chevron-right.9e26bb3a.js";import{o as s,c as n,a as e,p as j,X as U,r as m,u as J,s as T,d as g,Z as q,e as X,z as u,f as c,w,B as b,i as Y,j as D,F as k,v as C,t as $,x as I,h as Q,$ as W}from"./index.f7a1ecce.js";import{_ as Z}from"./map-pin-fill.531ed617.js";import{_ as G}from"./BrForm.5ef8a548.js";const K={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},ee=e("path",{fill:"currentColor",d:"M16.24 7.75A5.974 5.974 0 0 0 12 5.99v6l-4.24 4.24c2.34 2.34 6.14 2.34 8.49 0a5.99 5.99 0 0 0-.01-8.48zM12 1.99c-5.52 0-10 4.48-10 10s4.48 10 10 10s10-4.48 10-10s-4.48-10-10-10zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8s8 3.58 8 8s-3.58 8-8 8z"},null,-1),te=[ee];function se(_,o){return s(),n("svg",K,te)}var oe={name:"ic-outline-timelapse",render:se};const ne={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},re=e("path",{fill:"currentColor",d:"M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41L9 16.17z"},null,-1),ae=[re];function ie(_,o){return s(),n("svg",ne,ae)}var le={name:"ic-round-check",render:ie};const ce={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},de=e("path",{fill:"currentColor",d:"M26 20h-2v4h-4v2h4v4h2v-4h4v-2h-4z"},null,-1),me=e("path",{fill:"currentColor",d:"M28 8H16l-3.4-3.4c-.4-.4-.9-.6-1.4-.6H4c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h14v-2H4V6h7.2l3.4 3.4l.6.6H28v8h2v-8c0-1.1-.9-2-2-2z"},null,-1),pe=[de,me];function ue(_,o){return s(),n("svg",ce,pe)}var _e={name:"carbon-folder-add",render:ue};const he={class:"iom-impl-par pb-4 overflow-hidden md:p-1"},fe={key:0,class:"flex flex-col items-center justify-center relative md:px-12 py-6 transform"},ve=e("h5",{class:"text-dark-900 text-lg font-normal mt-3"},[e("span",null,"+"),Q(" Implementing Partner")],-1),xe={key:1,class:"pt-2 w-full h-full"},ye=["onClick","data-index"],ge={class:"shadow relative block border transition-all rounded-lg overflow-hidden"},we={class:"!leading-5 w-full !text-sm pl-4 px-2 py-2 border-b bg-primary-200/30 text-slate-700 cursor-default"},be={class:"p-3 pl-3 md:py-4 flex items-center text-xs"},ke={class:"space-y-2 flex-grow max-w-[50%] pr-2"},Ce={class:"flex items-center"},$e={class:"truncate"},Ie={class:"bg-primary-500 flex md:flex-grow text-xs justify-between !w-1/2 items-center relative transition duration-300 ring-1 ring-dark-100 rounded-lg overflow-hidden hover:opacity-90 hover:ring-primary-100 hover:cursor-pointer"},Se={class:"h-full relative mr-1 bg-slate-200/40 py-3 px-2 md:px-3 md:py-3 border-r"},ze=e("div",{class:"flex flex-col items-start my-2"},[e("span",{class:"underline underline-primary-200 flex items-center text-white font-medium"}," Staff Survey ")],-1),Ae={__name:"IP",setup(_){const o=j(),{width:S}=U(),d=m(""),v=m(null),z=m(null),x=m([]),h=m(!0),P=J(),M=({id:t})=>{o.isObserver&&!o.getSurveyStatus(t,"staff")?o.observerNotif403.open=!0:P.push({name:"staff-form",params:{ip:t}})},V=async(t,{setErrors:r,notify:p})=>{const a=await W(t);a.status===200&&(t.id=a.data.id,d.value="",o.$patch(l=>{l.ips.unshift(t)}))},B=()=>{},y=async(t={})=>{h.value=!0;const r=encodeURIComponent(JSON.stringify({population:{$gt:1e4},...t})),p=await fetch(`https://parseapi.back4app.com/classes/greeceCities_List_of_Greek_cities?limit=10&order=-population&keys=name&where=${r}`,{headers:{"X-Parse-Application-Id":"7ULzjba6mbRxuCi9O3umzEUnVhI5fcO14LCJlWeQ","X-Parse-REST-API-Key":"pOJV0euvADHJohCkybQkmxBb9oypFnztrcbOZ8zx"}});try{const a=await p.json();a&&a.results&&(x.value=a.results.map(l=>l.name).sort())}finally{h.value=!1}};T(async()=>{window.store=o,document.querySelectorAll(".iom-impl-par aside").forEach((t,r)=>{t.offsetHeight,t.style.height=0}),await y(),S.value>=768});const A=async()=>{d.value!=="add"&&(d.value="add")},E={form:{type:"stacked-int",save:"perForm"},fields:[{name:"name",label:"Name of the Implementing Institution",type:"text",parentClasses:"br-span-full",rules:g().required(),placeholder:"Red Cross"},{name:"locations",section:"aux",label:"Enter IP's locations",rules:q().min(1).required().of(g()),type:"tagger",parentClasses:"br-span-full",helpText:"Select city locations of this IP's facilities by typing in the city name, followed by comma or Enter",extra:{enableHints:!0,choicesLoading:h,choices:x,onSearchInput:async(t,r)=>{r==0&&await y({name:{$regex:t}})}}}]};return(t,r)=>{const p=_e,a=G,l=X("br-transition"),F=Z,L=le,N=oe,R=O;return s(),n("section",he,[u(o).isObserver?Y("",!0):(s(),n("article",{onClick:A,key:"add",class:"w-full group py-1 px-4 mt-4"},[e("div",{class:b(["overflow-hidden h-full flex items-center justify-center border-dashed bg-white transition-all cursor-pointer rounded-lg",[d.value!=="add"?"border-2 border-dark-200 hover:bg-dark-50":"transparent"]])},[c(l,{name:"verticalBlur",class:"w-full overflow-auto"},{default:w(()=>[d.value?(s(),n("div",xe,[c(a,D({ref_key:"addform",ref:z,"persist-state":!0,name:"addip",class:"iom-addip",modelValue:v.value,"onUpdate:modelValue":r[0]||(r[0]=i=>v.value=i)},{schema:E,onFormErrors:B,onFormValid:V},{"submit-text":"Create new IP"}),null,16,["modelValue"])])):(s(),n("div",fe,[c(p,{class:"text-dark-400 w-11 h-11"}),ve]))]),_:1})],2)])),c(l,{type:"group",name:"dissolve",duration:.6,tag:"ul",class:"flex flex-wrap <md:px-4 <md:mt-2"},{default:w(()=>[(s(!0),n(k,null,C(u(o).ips,(i,H)=>(s(),n("li",{key:i.name,onClick:f=>M(i),class:b([u(o).ui.menu=="full"?"tablet:max-w-1/2":"md:max-w-1/2","iom-part w-full <md:pt-0 py-3 md:px-3 md:py-3 lg:px-3 lg:py-3"]),"data-index":H},[e("section",ge,[e("h4",we,$(i.name),1),e("article",be,[e("ul",ke,[(s(!0),n(k,null,C(i.locations,f=>(s(),n("li",{key:f},[e("div",Ce,[c(F,{class:"w-4 h-4 mr-1 text-dark-400 flex-none"}),e("p",$e,$(f),1)])]))),128))]),e("div",Ie,[e("div",Se,[u(o).getSurveyStatus(i.id,"staff")=="ok"?(s(),I(L,{key:0,class:"text-slate-100 w-4 h-4 md:w-5 md:h-5"})):(s(),I(N,{key:1,class:"text-slate-200 w-5 h-5"}))]),ze,c(R,{class:"text-slate-200 mr-2"})])])])],10,ye))),128))]),_:1})])}}};export{Ae as default};
