import{o,c as s,A as p,i as d,a as c,B as Z,C as Tt,r as M,g as dt,D as Vt,E as wt,G as ut,n as Et,H as Lt,e as vt,x as z,w as C,z as b,_ as Rt,b as A,q as _,I as ct,J as It,K as Dt,L as Nt,M as mt,N as qt,O as At,P as Jt,f as tt,Q as ft,h as et,t as V,T as Ut,F as K,v as rt,R as at,j as bt,y as Pt,S as pt,U as Gt,V as Ht,W as Wt}from"./index.56909ae0.js";const Kt=["disabled"],Ot={key:0,class:"br-btn--icon"},Qt={key:1,class:"br-btn--icon",viewBox:"0 0 38 38"},jt=Tt('<defs><linearGradient x1="8.042%" y1="0%" x2="65.682%" y2="23.865%" id="a"><stop stop-color="#fff" stop-opacity="0" offset="0%"></stop><stop stop-color="#fff" stop-opacity=".631" offset="63.146%"></stop><stop stop-color="#fff" offset="100%"></stop></linearGradient></defs><g fill="none" fill-rule="evenodd"><g transform="translate(1 1)"><path d="M36 18c0-9.94-8.06-18-18-18" id="Oval-2" stroke="url(#a)" stroke-width="4"><animateTransform attributeName="transform" type="rotate" from="0 18 18" to="360 18 18" dur="0.9s" repeatCount="indefinite"></animateTransform></path><circle fill="#fff" cx="36" cy="18" r="1"><animateTransform attributeName="transform" type="rotate" from="0 18 18" to="360 18 18" dur="0.9s" repeatCount="indefinite"></animateTransform></circle></g></g>',2),te=[jt],ee={class:"relative"},re={key:0},ae={__name:"BrButton",props:{disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},setup(l){const h=l;return(w,X)=>w.$slots.default?(o(),s("button",{key:0,disabled:!!l.loading||l.disabled,tabindex:"0",class:Z([w.$attrs.class,"br-btn"])},[w.$slots.beforeicon&&!l.loading?(o(),s("div",Ot,[p(w.$slots,"beforeicon")])):d("",!0),h.loading?(o(),s("svg",Qt,te)):d("",!0),c("span",ee,[p(w.$slots,"default")])],10,Kt)):(o(),s("button",{key:1,class:Z([w.$attrs.class,"br-btn br-btn--lone-icon"])},[w.$slots.beforeicon&&!h.loading?(o(),s("div",re,[p(w.$slots,"beforeicon")])):d("",!0)],2))}},oe={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},se=c("g",{fill:"currentColor"},[c("path",{d:"M10.243 16.314L6 12.07l1.414-1.414l2.829 2.828l5.656-5.657l1.415 1.415l-7.071 7.07Z"}),c("path",{"fill-rule":"evenodd",d:"M1 12C1 5.925 5.925 1 12 1s11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12Zm11 9a9 9 0 1 1 0-18a9 9 0 0 1 0 18Z","clip-rule":"evenodd"})],-1),ie=[se];function ne(l,h){return o(),s("svg",oe,ie)}var le={name:"gg-check-o",render:ne};const de={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},ce=c("g",{fill:"currentColor"},[c("path",{d:"M12 6a1 1 0 0 1 1 1v6a1 1 0 1 1-2 0V7a1 1 0 0 1 1-1Zm0 10a1 1 0 1 0 0 2a1 1 0 0 0 0-2Z"}),c("path",{"fill-rule":"evenodd",d:"M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10s10-4.477 10-10S17.523 2 12 2ZM4 12a8 8 0 1 0 16 0a8 8 0 0 0-16 0Z","clip-rule":"evenodd"})],-1),me=[ce];function fe(l,h){return o(),s("svg",de,me)}var be={name:"gg-danger",render:fe};const pe={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},we=c("g",{fill:"currentColor"},[c("path",{d:"M16.34 9.322a1 1 0 1 0-1.364-1.463l-2.926 2.728L9.322 7.66A1 1 0 0 0 7.86 9.024l2.728 2.926l-2.927 2.728a1 1 0 1 0 1.364 1.462l2.926-2.727l2.728 2.926a1 1 0 1 0 1.462-1.363l-2.727-2.926l2.926-2.728Z"}),c("path",{"fill-rule":"evenodd",d:"M1 12C1 5.925 5.925 1 12 1s11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12Zm11 9a9 9 0 1 1 0-18a9 9 0 0 1 0 18Z","clip-rule":"evenodd"})],-1),ue=[we];function ve(l,h){return o(),s("svg",pe,ue)}var ge={name:"gg-close-o",render:ve};const he={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},ye=c("g",{fill:"currentColor"},[c("path",{d:"M11 10.98a1 1 0 1 1 2 0v6a1 1 0 1 1-2 0v-6Zm1-4.929a1 1 0 1 0 0 2a1 1 0 0 0 0-2Z"}),c("path",{"fill-rule":"evenodd",d:"M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10s10-4.477 10-10S17.523 2 12 2ZM4 12a8 8 0 1 0 16 0a8 8 0 0 0-16 0Z","clip-rule":"evenodd"})],-1),xe=[ye];function ke(l,h){return o(),s("svg",he,xe)}var _e={name:"gg-info",render:ke};const ze={key:0,class:"br-notify-preicon"},$e={class:"br-notify--content"},Se={key:0},Fe={key:1},Ye={key:0},Ze={__name:"BrNotification",props:{autoClose:{default:!1,type:Boolean},closable:{default:!0,type:Boolean},level:{default:"",type:String},onComplete:{default:()=>{},type:Function},show:{default:!1,type:Boolean}},emits:["update:show"],setup(l,{emit:h}){const w=l,X=M(!1),B=M(null),J=M(null);let m=dt.timeline();const E=Vt(),{show:U,autoClose:L,onComplete:P}=wt(w);function G(f){if(!f.el&&f.children)return f.children.length*60/1e3;if(!f.el&&f.dynamicProps[0])return f.props.innerHTML.length*60/1e3;const $=f.el.textContent,x=$.match(/[A-Z]/g);return($.length+(x?x.length-1:0))*60/1e3}return ut(U,async f=>{if(m&&m.isActive())return;await Et();const y=E.default()[0],$=E.desc&&E.desc()[0];if(y&&f&&L.value){const x=G(y),S=$&&G($)||0;m.to(J.value,{width:B.value.offsetWidth,delay:1,duration:x+S,ease:"linear",onComplete:()=>{h("update:show",!1),m=dt.timeline(),P.value&&P.value()}})}},{immediate:!0}),Lt(async()=>{X.value?m.pause():!X.value&&m&&m.paused()&&setTimeout(()=>{m.resume()},200)}),(f,y)=>{const $=_e,x=ge,S=be,H=le,R=Rt,k=vt("br-transition");return o(),z(k,{name:"horizontalBlurRight"},{default:C(()=>[b(U)?(o(),s("section",{key:0,ref_key:"notify",ref:B,class:Z(["br-notify group",`br-notify__${l.level}`]),onMouseover:y[1]||(y[1]=I=>X.value=!0),onMouseleave:y[2]||(y[2]=I=>X.value=!1)},[c("article",null,[b(L)?(o(),s("div",{key:0,ref_key:"progress",ref:J,class:"br-notify--progress"},null,512)):d("",!0),p(f.$slots,"preicon",{},()=>[l.level?(o(),s("section",ze,[l.level=="info"?(o(),z($,{key:0})):d("",!0),l.level=="danger"?(o(),z(x,{key:1})):d("",!0),l.level=="warning"?(o(),z(S,{key:2})):d("",!0),l.level=="success"?(o(),z(H,{key:3})):d("",!0)])):d("",!0)]),c("div",$e,[c("span",null,[p(f.$slots,"default")]),f.$slots.desc?(o(),s("span",Se,[p(f.$slots,"desc")])):d("",!0),f.$slots["inline-actions"]?(o(),s("span",Fe,[p(f.$slots,"inline-actions")])):d("",!0)]),p(f.$slots,"aftericon",{},()=>[l.closable&&!f.$slots.actions?(o(),s("section",Ye,[l.closable?(o(),z(R,{key:0,class:"br-notify--close",onClick:y[0]||(y[0]=I=>h("update:show",!1))})):d("",!0)])):d("",!0)]),p(f.$slots,"actions")])],34)):d("",!0)]),_:3})}}};const Xe=["onSubmit"],Be=["innerHTML"],Ce={key:0,class:"br-form--section-header"},Me={key:0},Te={key:1},Ve=["id"],Ee={key:0,class:"br-form--ext-label"},Le={key:0,class:"br-form--ext-label--required"},Re=c("span",null,null,-1),Ie=[Re],De={class:"br-form--field"},Ne={class:"br-form--submit"},Pe={__name:"BrForm",props:{name:{type:String,required:!0},debounceInterval:{type:Number,default:700},modelValue:{type:Object,default:()=>({})},onFieldValid:{type:Function,default:async()=>{}},onFormErrors:{type:Function,default:async()=>{}},onFormValid:{type:Function,default:async()=>{}},persistState:{type:Boolean,default:!1},rootLoading:{type:Boolean,default:!1},submitText:{type:String,default:"Submit"},submittingText:{type:String,default:"Submitting..."},schema:{type:Object,default:()=>({})},wrapperClass:{type:[Array,String],default:""}},emits:["update:modelValue"],setup(l,{emit:h}){const w=l,X=["password"],B=A({}),{modelValue:J,schema:m,debounceInterval:E,name:U,persistState:L,rootLoading:P}=wt(w),G=["checkbox","switch"],f=A({}),y=M({}),$=M({}),x=A({}),S=M({}),H=M(!1),R=`br:formperm:${U.value}`,k=A({msg:"",desc:"",open:!1,level:"info"});function I(e,t,r){k.level=r,k.msg=e,k.desc=t,k.open=!0}const F=_(()=>m.value.form&&m.value.form.save||"perForm"),O=_(()=>(m.value.form||{}).type||"stacked"),gt=["selectionBox","decision","mapping"],ht=_(()=>Object.fromEntries(m.value.fields.map(e=>[e.name,gt.includes(ct(e.type,!0))]))),yt=_(()=>m.value.fields.filter(e=>X.includes(e.type)).map(e=>e.name)),ot=e=>{if(F.value==="perForm"&&L.value){const t=Object.fromEntries(Object.entries(e).filter(([r,a])=>a!==void 0&&!yt.value.includes(r)));localStorage.setItem(R,JSON.stringify(t))}},Q=_(()=>{let e=Object.fromEntries(m.value.fields.map((t,r)=>{if(t.type==="select")m.value.fields[r].mode=t.rules.type==="array"?"multi":"single";else if(t.type==="radio")m.value.fields[r].mode="single";else if(G.includes(t.type))m.value.fields[r].mode="multi";else if(t.type==="mapping"){const{data:a,rules:{fields:u}}=t;for(const v in a){const{label:i}=a[v];u[v].spec.label=i}}return[t.name,t.rules.label(t.label)]}));return It().shape(e)}),D=_(()=>{var e=A(J.value||{});if(F.value==="perForm"&&L.value){let t=Dt(R)||{};Object.assign(t,e),e=t}return e});_(()=>{const e=["mapping"];return m.value.fields.filter(({type:t})=>e.includes(t)).map(({name:t})=>t)});const{handleSubmit:xt,isSubmitting:N,setFieldError:qe,setErrors:j,errors:st,meta:q,submitForm:Ae,values:W}=Nt({validationSchema:Q.value,initialValues:D.value}),kt=_(()=>Object.entries(st.value).reduce((t,r)=>{let[a,u]=r;return a.match(".")?(a=a.split(".")[0],t[a]||(t[a]=[]),t[a].push(u)):t[a]=u,t},{}));mt("IS_FORM_SUBMITTING",N),mt("FORM_MODE",F);const _t=Ht(),zt=["stacked-int","stacked-2col-int","stacked-disjoint-int"],$t=_(()=>{const e=Object.entries(Q.value.resolve({}).describe().fields);return Object.fromEntries(e.map(([t,r])=>[t,r.type==="object"?[r]:r.tests]))}),St=({name:e})=>P.value||N.value||!!x[e],T={},Ft=qt(async([e,t])=>{let r=T[t];if(r=r==null||r==null?q.value.initialValues[t]:r,e instanceof Object){if(JSON.stringify(e)===JSON.stringify(r))return;T[t]=JSON.parse(JSON.stringify(e))}else{if(r==e)return;T[t]=e}x[t]=!0;const a=v=>S.value[t]=v,u=v=>j({[t]:v});await w.onFieldValid(t,{value:e,setSuccessText:a,setError:u}),x[t]=!1},E.value),it=async(e,t,r=null)=>{if(!t&&t!==0&&t!==!1)return;let a=T[r||e];if(a=a==null||a==null?q.value.initialValues[r||e]:a,t instanceof Object){if(JSON.stringify(t)===JSON.stringify(a))return;T[r||e]=JSON.parse(JSON.stringify(t))}else{if(a==t)return;T[r||e]=t}x[e]=!0;const u=i=>{S.value[e]=i},v=i=>j({[e]:i});await w.onFieldValid(r||e,{value:t,setSuccessText:u,setError:v}),x[e]=!1},Yt=async([e,t])=>{const[r,a]=e.split(":"),u=f[e];D.value[u]=t,h("update:modelValue",D.value),F.value==="perField"?await it(r,t,u):ot(D.value)},Zt=_(()=>{if(!m.value)return{};const e=[];for(let t of m.value.fields){const{models:r,name:a,hidden:u}=t;if(u)continue;const v=ht.value[a];if(t.isCompound=v,F.value==="perField"?(At.includes(t.type)?t.handleFieldBlur=async(i,...g)=>{B[a]=!1,i&&await it(...g)}:t.handleFieldDebounced=Ft,t.successText=S.value[a],t.loading=St({name:a})):t.handleFieldDebounced=t.handleFieldBlur=()=>{B[a]=!1},t.schema=$t.value[a],t.validationSchema=Q.value.fields[a],t.isRequired=Object.values(t.schema).some(({name:i})=>i==="required"),O.value.match("-int"))t.displayExtLabel=!1,t.displayLabel=!0;else{const i=!zt.includes(O.value);t.displayExtLabel=i&&!v,t.displayLabel=i&&v}t.id=t.id!=null?t.id:`br-field--${t.name}`,r&&Object.entries(r).map(([i,{name:g}])=>{delete m.value.models,t[g]=D.value[i],f[`${a}:${g}`]=i}),e.push(t)}return{...m.value,fields:e}}),Xt=_(()=>{let e=Object.assign({},Zt.value);const t=e.sections;if(!t)return{"":{fields:e.fields}};for(let r in e.sections)t[r].fields=new Set;for(let r of e.fields){const{section:a="default"}=r;t[a]||(t[a]={}),t[a].fields||(t[a].fields=new Set),t[a].fields.add(r)}return t}),nt=()=>{S.value={}},Bt=xt(async e=>{localStorage.setItem(R,JSON.stringify({})),await w.onFormValid(e,{setErrors:j,notify:I}),H.value=!0,_t.provides[Jt]},async({values:e,errors:t,results:r})=>{await w.onFormErrors({values:e,errors:t,results:r,notify:I})}),Ct=(...e)=>{if(F.value!=="perField")return Bt(...e)};return ut(W,e=>{h("update:modelValue",e),H.value||ot(e)}),(e,t)=>{const r=Ze,a=Wt,u=vt("br-transition"),v=ae;return o(),s("form",{class:Z(["br-form",`br-form__${b(O)}`]),novalidate:"",target:"_self",enctype:"application/json",onSubmit:Gt(Ct,["prevent"])},[(o(),z(Ut,{to:"body"},[tt(r,{show:k.open,"onUpdate:show":t[0]||(t[0]=i=>k.open=i),"auto-close":!0,level:k.level},ft({default:C(()=>[c("span",{innerHTML:k.msg},null,8,Be)]),_:2},[k.desc?{name:"desc",fn:C(()=>[et(V(k.desc),1)])}:void 0]),1032,["show","level"])])),c("section",null,[p(e.$slots,"before-fields",{errors:b(st)}),c("section",{class:Z(["br-form--main",l.wrapperClass])},[(o(!0),s(K,null,rt(b(Xt),(i,g)=>(o(),z(u,{key:g,name:"horizontalBlur2"},{default:C(()=>[i.hidden?d("",!0):(o(),s("article",{key:0,ref_for:!0,ref:n=>{n&&($.value[g]=n)},class:Z(["br-form--section",i.classes||[]])},[g?p(e.$slots,`before-section-${g}`,{key:0}):d("",!0),g?p(e.$slots,`section-${g}`,at(bt({key:1},i)),()=>[i.label?(o(),s("header",Ce,[i.label?(o(),s("h3",Me,V(i.label),1)):d("",!0),i.helpText?(o(),s("div",Te,V(i.helpText),1)):d("",!0)])):d("",!0)]):d("",!0),g?p(e.$slots,`prepend-section-${g}`,{key:2}):d("",!0),tt(u,{name:"dissolve",class:"br-form--fields-wrap",tag:"div",type:"group"},{default:C(()=>[(o(!0),s(K,null,rt(i.fields,n=>(o(),s("div",{key:n.name,id:n.id,ref_for:!0,ref:Y=>{Y&&(y.value[n.name]=Y)},class:Z(["field",[b(kt)[n.name]?"br-errored":"",n.parentClasses||""]]),tabindex:"0",onClick:nt,onFocus:nt},[n.displayExtLabel?(o(),s("article",Ee,[n.isRequired?(o(),s("div",Le)):d("",!0),c("label",null,V(n.label),1),tt(a,{loading:n.loading},null,8,["loading"])])):!n.isCompound&&n.isRequired?(o(),s("div",{key:1,class:Z(["br-form--ext-label--required br-plain-field",B[n.name]?"br-plain-field__focused":""])},Ie,2)):d("",!0),c("section",null,[c("div",De,[(o(),z(Pt(b(ct)(n.type)),bt({modelValue:b(W)[n.name],"onUpdate:modelValue":Y=>b(W)[n.name]=Y},n,{class:[n.classes||""],"onUpdate:auxModel":Yt,onFieldupdated:n.handleFieldDebounced,onFieldBlur:({valid:Y})=>n.handleFieldBlur(Y,n.name,b(W)[n.name]),onFocusToggle:Y=>B[n.name]=!0}),ft({_:2},[rt(e.$slots,(Y,lt)=>({name:lt,fn:C(Mt=>[p(e.$slots,lt,at(pt(Mt)))])}))]),1040,["modelValue","onUpdate:modelValue","class","onFieldupdated","onFieldBlur","onFocusToggle"]))])]),p(e.$slots,`after-field-${n.name}`)],42,Ve))),128)),p(e.$slots,"after-fields")]),_:2},1024)],2))]),_:2},1024))),128))],2),c("div",Ne,[p(e.$slots,"submit-button",at(pt({formMode:b(F),meta:b(q),isSubmitting:b(N),submitText:l.submitText,submittingText:l.submittingText})),()=>[b(F)==="perForm"?(o(),z(v,{key:0,class:"br-btn--main br-form--submit-btn",type:"submit",disabled:b(q).touched&&!b(q).valid,loading:b(N)},{default:C(()=>[b(N)?(o(),s(K,{key:1},[et(V(l.submittingText),1)],64)):(o(),s(K,{key:0},[et(V(l.submitText),1)],64))]),_:1},8,["disabled","loading"])):d("",!0)])])])],42,Xe)}}};export{Pe as _,ae as a};
